<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025å¾·å›½åŠä¸œæ¬§æ—…è¡Œè¡Œç¨‹å•</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #EAE0DA;
            color: #5C5A58;
        }
        h1, h2 { color: #4E4A47; }
        .day {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #B8B5B2;
            border-radius: 8px;
            background-color: #F2ECE4;
        }
        .expense-category {
            margin-top: 10px;
        }
        .expense-category label {
            display: inline-block;
            width: 80px;
        }
        .notes {
            margin-top: 10px;
            padding: 5px;
            border: 1px solid #ccc;
            background: #f9f9f9;
            min-height: 50px;
        }
        #map {
            height: 500px;
            width: 100%;
            margin-top: 20px;
            border-radius: 8px;
        }
        button {
            margin-top: 10px;
            padding: 8px 16px;
            background-color: #4E4A47;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #6C6865;
        }
    </style>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            var map = L.map('map').setView([48.1351, 11.5820], 4);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'
            }).addTo(map);

            var locations = [
                {name: "å¾·ç´¯æ–¯é¡¿", lat: 51.0504, lng: 13.7373},
              	{name: "å¸ƒæ‹‰æ ¼", lat: 50.0755, lng: 14.4378},
              	{name: "ä¼Šæ–¯å¦å¸ƒå°”", lat: 41.0082, lng: 28.9784},
                {name: "é›…å…¸", lat: 37.9878, lng: 23.7324},
                {name: "å¸ƒè¾¾ä½©æ–¯", lat: 47.4979, lng: 19.0402},
              	{name: "æŸæ—", lat: 52.5200, lng: 13.4050}
            ];

            var latlngs = locations.map(loc => [loc.lat, loc.lng]);

            locations.forEach(location => {
                L.marker([location.lat, location.lng]).addTo(map)
                    .bindPopup(`<b>${location.name}</b>`);
            });

            L.polyline(latlngs, {color: 'red'}).addTo(map);
        }

        // æ›´æ–°æ€»æ”¯å‡º
        function updateTotalExpense() {
            let totalExpense = 0;
            document.querySelectorAll('.day').forEach(day => {
                let accommodation = parseFloat(day.querySelector('.accommodation-input').value) || 0;
                let transport = parseFloat(day.querySelector('.transport-input').value) || 0;
                let play = parseFloat(day.querySelector('.play-input').value) || 0;
                let food = parseFloat(day.querySelector('.food-input').value) || 0;
                let shopping = parseFloat(day.querySelector('.shopping-input').value) || 0;
                totalExpense += accommodation + transport + play + food + shopping;
            });
            document.getElementById('total-expense').innerText = `æ€»æ”¯å‡º: â‚¬${totalExpense.toFixed(2)}`;
            saveData(); // ä¿å­˜æ•°æ®
        }

                // ä¿å­˜æ•°æ®åˆ° localStorage
        function saveData() {
            let activities = [];
            document.querySelectorAll('.day').forEach(day => {
                let title = day.querySelector('h3').innerText;
                let details = day.querySelector('.details').innerText;
                let accommodation = day.querySelector('.accomodation-input').value;
                let transport = day.querySelector('.transport-input').value;
                let play = day.querySelector('.play-input').value;
                let food = day.querySelector('.food-input').value;
                let shopping = day.querySelector('.shopping-input').value;
                let notes = day.querySelector('.notes').innerHTML;
                activities.push({ title, details, accommodation, transport, play, food, shopping, notes });
            });
            let todos = Array.from(document.querySelectorAll('#todo-list li')).map(item => ({ text: item.innerText, checked: item.querySelector('input').checked }));
            let shoppingList = Array.from(document.querySelectorAll('#shopping-list li')).map(item => ({ text: item.innerText, checked: item.querySelector('input').checked }));
            
            localStorage.setItem('travelData', JSON.stringify(activities));
            localStorage.setItem('todoList', JSON.stringify(todos));
            localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
        }

        // åŠ è½½æ•°æ®ï¼Œæ¯æ¬¡åˆå§‹åŒ–æ—¶éƒ½åŠ è½½
        function loadData() {
            let data = localStorage.getItem('travelData');
            let activities = data ? JSON.parse(data) : [];

            if (activities.length === 0) {
                console.log("No saved data, using default activities...");
                activities = [
                    { title: "3æœˆ9æ—¥ - æŸæ— â†’ å¾·ç´¯æ–¯é¡¿", details: "äº¤é€š: ğŸšŒ FLIXBUS æŸæ—BER->å¾·ç´¯æ–¯é¡¿Hbf\næ¸¸è§ˆè®¡åˆ’: ğŸ“Œ å¾·ç´¯æ–¯é¡¿ï¼šåšç‰©é¦†\n è´­ç‰©æ¸…å•: æ— ", accommodation: 0, transport: 58, play: 0, food: 0, shopping: 0, notes: "8:00 å¼ å¯¼åˆ°è¾¾æŸæ—æœºåœºæ¥æœºï¼Œé¢„è®¡é©¬å¥³å£«å‡ºå…³æ—¶é—´1å°æ—¶\n 9:25 åä¸ŠFlixbuså¤§å·´è½¦\n 12:05 åˆ°è¾¾å¼ å¯¼å…¬å¯“å®‰é¡¿\n 14:00 å‡ºå‘å»å¾·ç´¯æ–¯é¡¿æ˜“åŒ—æ²³è€åŸåŒº\n 18:00 æ™šé¥­ \n 20:00 å›å…¬å¯“æ”¶æ‹¾è¡Œæç¡è§‰" },
                    { title: "3æœˆ10æ—¥ - å¾·ç´¯æ–¯é¡¿ â†’ å¸ƒæ‹‰æ ¼", details: "äº¤é€š: ğŸš„ ç«è½¦ å¾·ç´¯æ–¯é¡¿Hbfå‰å¾€å¸ƒæ‹‰æ ¼Praha hl.n. 8:10-10:26ï¼ˆ2å°æ—¶16åˆ†é’Ÿï¼‰\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ å¸ƒæ‹‰æ ¼: è‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: å†°ç®±è´´", accommodation: 80.00, transport: 100.00, play: 20.00, food: 40.00, shopping: 30.00, notes: "" },
                    { title: "3æœˆ11æ—¥ - å¸ƒæ‹‰æ ¼ â†’ ä¼Šæ–¯å¦å¸ƒå°”", details: "äº¤é€š: âœˆï¸ é£æœº å¸ƒæ‹‰æ ¼PRGå‰å¾€ä¼Šæ–¯å¦å¸ƒå°”SAW 09:20-13:55\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ ä¼Šæ–¯å¦å¸ƒå°”ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: å†°ç®±è´´ï¼Œé¦™æ°´å°ç“¶", accommodation: 120.00 , transport: 161.20, play: 80.00, food: 80.00, shopping:50.00, notes: "" },
                    { title: "3æœˆ12æ—¥ - ä¼Šæ–¯å¦å¸ƒå°”", details: "äº¤é€š: ğŸšŒğŸš¢ å¸‚å†…äº¤é€š\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ ä¼Šæ–¯å¦å¸ƒå°”ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: æš‚æ— ", accommodation: 120.00 ,transport: 40.00, play: 200.00, food: 80.00, shopping:70.00, notes: "" },
                    { title: "3æœˆ13æ—¥ - ä¼Šæ–¯å¦å¸ƒå°”", details: "äº¤é€š: ğŸšŒğŸš¢ å¸‚å†…äº¤é€š\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ ä¼Šæ–¯å¦å¸ƒå°”ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: æš‚æ— ", accommodation: 120.00 ,transport: 20.00, play: 200.00, food: 80.00, shopping:50.00, notes: "" },
                    { title: "3æœˆ14æ—¥ - ä¼Šæ–¯å¦å¸ƒå°” â†’ é›…å…¸", details: "äº¤é€š: âœˆï¸ é£æœº ä¼Šæ–¯å¦å¸ƒå°”ISTå‰å¾€é›…å…¸ATH 12:00-12:25ï¼ˆ1å°æ—¶25åˆ†é’Ÿï¼‰\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ é›…å…¸ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: æ— ", accommodation: 100.00 ,transport: 161.20, play: 80.00, food: 80.00, shopping:50.00, notes: "" },
                    { title: "3æœˆ15æ—¥ - é›…å…¸", details: "äº¤é€š: ğŸšŒğŸš¢ å¸‚å†…äº¤é€š\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ é›…å…¸ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: æš‚æ— ", accommodation: 100.00 , transport: 20.00, play: 80.00, food: 80.00, shopping:30.00, notes: "" },
                    { title: "3æœˆ16æ—¥ - é›…å…¸ â†’ å¸ƒè¾¾ä½©æ–¯", details: "äº¤é€š: âœˆï¸ é£æœº é›…å…¸ATHå‰å¾€å¸ƒè¾¾ä½©æ–¯BUD 05:50-07:00ï¼ˆ2å°æ—¶10åˆ†é’Ÿï¼‰\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ å¸ƒè¾¾ä½©æ–¯ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: å†°ç®±è´´", accommodation: 100.00 ,transport: 148.42, play: 40.00, food: 60.00, shopping:50.00, notes: "" },
                    { title: "3æœˆ17æ—¥ - å¸ƒè¾¾ä½©æ–¯", details: "äº¤é€š: ğŸšŒğŸš¢ å¸‚å†…äº¤é€š\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ å¸ƒè¾¾ä½©æ–¯ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: æš‚æ— ", accommodation: 100.00 , transport: 20.00, play: 80.00, food: 80.00, shopping:30.00, notes: "" },
                    { title: "3æœˆ18æ—¥ - å¸ƒè¾¾ä½©æ–¯ â†’ æŸæ— â†’ å¾·ç´¯æ–¯é¡¿", details: "äº¤é€š: âœˆï¸ é£æœº å¸ƒè¾¾ä½©æ–¯BUDå‰å¾€æŸæ—BER 11:30-13:00ï¼ˆ1å°æ—¶30åˆ†é’Ÿï¼‰ ğŸš„ ç«è½¦ æŸæ—å‰å¾€å¾·ç´¯æ–¯é¡¿Hbf 19:05-21:07ï¼ˆ2å°æ—¶2åˆ†é’Ÿï¼‰\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ æŸæ—ï¼šè‡ªç”±è¡Œï¼Œå¾·ç´¯æ–¯é¡¿ï¼šè‡ªç”±è¡Œ\n è´­ç‰©æ¸…å•: å†°ç®±è´´", accommodation: 0 ,transport: 150.37, play: 40.00, food: 20.00, shopping: 100.00, notes: "" },
                    { title: "3æœˆ19æ—¥ - å¾·ç´¯æ–¯é¡¿", details: "äº¤é€š: ğŸšŒ å¸‚å†…äº¤é€š\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ å¾·ç´¯æ–¯é¡¿ï¼šå°ç‘å£«å›½å®¶å…¬å›­\n è´­ç‰©æ¸…å•: æš‚æ— ", accommodation: 0 , transport: 10.00, play: 80.00, food: 40.00, shopping:60.00, notes: "" },
                    { title: "3æœˆ20æ—¥ - å¾·ç´¯æ–¯é¡¿", details: "äº¤é€š: ğŸšŒ å¸‚å†…äº¤é€š\n æ¸¸è§ˆè®¡åˆ’: ğŸ“Œ å¾·ç´¯æ–¯é¡¿ï¼šåŠå…¬å®¤ï¼Œæ˜Ÿå·´å…‹ï¼Œè´­ç‰©\n è´­ç‰©æ¸…å•: æš‚æ— ", accommodation: 0 , transport: 10.00, play: 80.00, food: 40.00, shopping:260.00, notes: "" },
                    { title: "3æœˆ21æ—¥ - å¾·ç´¯æ–¯é¡¿ â†’ æŸæ—", details: "äº¤é€š:  ğŸšŒ FLIXBUS å¾·ç´¯æ–¯é¡¿Hbfå‰å¾€æŸæ—BER 7:50-10:00ï¼ˆ2å°æ—¶10åˆ†é’Ÿï¼‰\n æ¸¸è§ˆè®¡åˆ’: æ— \n è´­ç‰©æ¸…å•: æ— ", accommodation: 0, transport: 40.00, play: 0, food: 20.00, shopping: 30.00, notes: "" }
                ];
                localStorage.setItem('travelData', JSON.stringify(activities));
            }
            
            // æ¸…ç©ºæ—§æ•°æ®ï¼Œé‡æ–°åŠ è½½
            document.getElementById("activities").innerHTML = "";
            activities.forEach(activity => {
                addActivity(activity.title, activity.details, activity.accommodation, activity.transport, activity.play, activity.food, activity.shopping, activity.notes);
            });

            updateTotalExpense();
         	
          	let todos = JSON.parse(localStorage.getItem('todoList')) || [];
            let shoppingList = JSON.parse(localStorage.getItem('shoppingList')) || [];
            updateList('todo-list', todos);
            updateList('shopping-list', shoppingList);

        }

        // æ·»åŠ è¡Œç¨‹æ´»åŠ¨
        function addActivity(title, details, accommodation = 0, transport = 0, play = 0, food = 0, shopping = 0, notes = "") {
            let container = document.getElementById("activities");
            let newActivity = document.createElement("div");
            newActivity.classList.add("day");
            newActivity.innerHTML = `
                <h3>${title}</h3>
                <p class="details">${details.replace(/\n/g, '<br>')}</p>
                <div class="expense-category">
                    <label>ä½å®¿:</label>
                    <input type="number" class="accommodation-input" value="${accommodation}" onchange="updateTotalExpense()"> â‚¬
                </div>
                <div class="expense-category">
                    <label>äº¤é€š:</label>
                    <input type="number" class="transport-input" value="${transport}" onchange="updateTotalExpense()"> â‚¬
                </div>
                <div class="expense-category">
                    <label>æ¸¸ç©:</label>
                    <input type="number" class="play-input" value="${play}" onchange="updateTotalExpense()"> â‚¬
                </div>
                <div class="expense-category">
                    <label>é¥®é£Ÿ:</label>
                    <input type="number" class="food-input" value="${food}" onchange="updateTotalExpense()"> â‚¬
                </div>
                <div class="expense-category">
                    <label>è´­ç‰©:</label>
                    <input type="number" class="shopping-input" value="${shopping}" onchange="updateTotalExpense()"> â‚¬
                </div>
                <div class="notes" contenteditable="true" style="margin-top:10px; padding:5px; border:1px solid #ccc; background:#f9f9f9;">${notes}</div>
            `;
            container.appendChild(newActivity);
        }
      
      	function updateList(id, items) {
            let list = document.getElementById(id);
            list.innerHTML = '';
            items.forEach(item => {
                let li = document.createElement('li');
                let checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = item.checked;
                li.appendChild(checkbox);
                li.appendChild(document.createTextNode(item.text));
                list.appendChild(li);
            });
        }

        function addItem(id) {
            let input = document.getElementById(id + '-input');
            let list = document.getElementById(id);
            if (input.value.trim() !== "") {
                let li = document.createElement('li');
                let checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                li.appendChild(checkbox);
                li.appendChild(document.createTextNode(input.value));
                list.appendChild(li);
                input.value = "";
            }
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = function() {
            initMap();
            loadData(); // ç›´æ¥åŠ è½½æ•°æ®
        };
    </script>
</head>
<body>
    <h1>å¾·å›½åœŸè€³å…¶å¥¥åœ°åˆ©æ·å…‹æ—…è¡Œè¡Œç¨‹å•ï¼ˆ2025å¹´3æœˆ9æ—¥ - 2025å¹´3æœˆ21æ—¥ï¼‰</h1>
  	<div id="map"></div>
    <h2>ä»£åŠäº‹å®œ</h2>
    <input type="text" id="todo-list-input" placeholder="è¾“å…¥ä»£åŠäº‹é¡¹...">
    <button onclick="addItem('todo-list')">æ·»åŠ </button>
    <ul id="todo-list"></ul>
    
    <h2>è´­ç‰©æ¸…å•</h2>
    <input type="text" id="shopping-list-input" placeholder="è¾“å…¥è´­ç‰©é¡¹ç›®...">
    <button onclick="addItem('shopping-list')">æ·»åŠ </button>
    <ul id="shopping-list"></ul>
    
    <h2>æ¯æ—¥è¡Œç¨‹</h2>
    <div id="activities"></div>
    
    <h2>ğŸ’° æ€»æ”¯å‡º</h2>
    <p id="total-expense">æ€»æ”¯å‡º: â‚¬0.00</p>
</body>
</html>
